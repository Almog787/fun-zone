<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>NVDA Strategic Intelligence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Assistant:wght@200;400;700;800&display=swap');
        body { font-family: 'Assistant', sans-serif; background-color: #0a0a0c; color: #e2e8f0; }
        .card { background: rgba(23, 23, 26, 0.7); border: 1px solid #2d2d33; backdrop-filter: blur(10px); }
    </style>
</head>
<body class="p-4">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="flex justify-between items-center mb-10 bg-[#111] p-6 rounded-3xl border border-[#222]">
            <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-[#76b900] rounded-xl flex items-center justify-center text-black">
                    <i class="fas fa-microchip text-2xl"></i>
                </div>
                <h1 class="text-2xl font-black uppercase tracking-tighter">NVDA <span class="text-[#76b900]">Intelligence</span></h1>
            </div>
            <div id="last-update" class="text-[10px] text-slate-500 font-mono">טוען...</div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <!-- Recommendation -->
            <div class="lg:col-span-1 flex flex-col gap-6">
                <div class="card p-8 rounded-[2.5rem] text-center border-t-4 border-[#76b900]">
                    <div class="text-[10px] font-bold text-slate-500 uppercase mb-4 tracking-widest">מנוע החלטות</div>
                    <div id="signal-text" class="text-6xl font-black mb-4 italic tracking-tighter uppercase">---</div>
                    <div id="signal-desc" class="text-xs text-slate-400">מנתח נתונים היסטוריים...</div>
                </div>
                <div class="card p-6 rounded-3xl">
                    <div class="flex justify-between mb-4"><span>מחיר נוכחי:</span><b id="price">---</b></div>
                    <div id="rsi-display" class="flex justify-between"><span>מדד RSI:</span><b id="rsi-val">---</b></div>
                </div>
            </div>

            <!-- Chart -->
            <div class="lg:col-span-3 card p-6 rounded-[2.5rem]">
                <canvas id="mainChart" height="140"></canvas>
            </div>
        </div>
    </div>

    <script>
        async function loadData() {
            try {
                // משיכת הקובץ המתוקן
                const res = await fetch('nvda_full_history.json?v=' + Date.now());
                const data = await res.json();
                
                const latest = data.metadata;
                const history = data.history;

                // עדכון UI
                document.getElementById('price').innerText = `$${latest.current_price.toFixed(2)}`;
                document.getElementById('rsi-val').innerText = latest.rsi.toFixed(2);
                document.getElementById('last-update').innerText = "Update: " + latest.last_updated;

                // לוגיקת איתותים
                const sig = document.getElementById('signal-text');
                const desc = document.getElementById('signal-desc');
                if(latest.rsi <= 35) {
                    sig.innerText = "BUY"; sig.className = "text-6xl font-black mb-4 text-emerald-500 italic";
                    desc.innerText = "מכירת יתר קיצונית. פוטנציאל היפוך גבוה.";
                } else if(latest.rsi >= 70) {
                    sig.innerText = "SELL"; sig.className = "text-6xl font-black mb-4 text-rose-500 italic";
                    desc.innerText = "קניית יתר. מומלץ לשקול מימוש רווחים.";
                } else {
                    sig.innerText = "HOLD"; sig.className = "text-6xl font-black mb-4 text-slate-500 italic";
                    desc.innerText = "המניה בטווח דשדוש. אין איתות חזק כרגע.";
                }

                renderChart(history);
            } catch (e) {
                document.getElementById('signal-desc').innerText = "ממתין לנתונים הראשוניים מ-GitHub Actions...";
            }
        }

        function renderChart(history) {
            const ctx = document.getElementById('mainChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: history.map(h => h.Datetime),
                    datasets: [
                        { label: 'Price', data: history.map(h => h.Close), borderColor: '#76b900', borderWidth: 2, pointRadius: 0, fill: false },
                        { label: 'SMA200', data: history.map(h => h.SMA200), borderColor: '#f59e0b', borderWidth: 1, pointRadius: 0, fill: false }
                    ]
                },
                options: {
                    responsive: true,
                    scales: { x: { display: false }, y: { grid: { color: '#222' } } },
                    plugins: { legend: { display: false } }
                }
            });
        }

        window.onload = loadData;
    </script>
</body>
</html>
